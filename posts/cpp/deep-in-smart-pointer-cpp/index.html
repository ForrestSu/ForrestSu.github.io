<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>深入理解C&#43;&#43;11智能指针 | 程序员的冷浪漫</title>
    <meta property="og:title" content="深入理解C&#43;&#43;11智能指针 - 程序员的冷浪漫">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2017-04-07T20:54:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2017-04-07T20:54:00&#43;08:00'>
        
    <meta name="Keywords" content="C&#43;&#43;, zeromq, libuv, seastar, golang">
    <meta name="description" content="深入理解C&#43;&#43;11智能指针">
        
    <meta name="author" content="ForrestSun">
    <meta property="og:url" content="https://forrestsu.github.io/posts/cpp/deep-in-smart-pointer-cpp/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
        <link href="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" rel="stylesheet">
    
    
    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://forrestsu.github.io">
                        程序员的冷浪漫
                    </a>
                
                <p class="description">专注于异步, 高并发, 低延时, 高吞吐, 分布式服务, 软件架构C&#43;&#43;/Golang </p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://forrestsu.github.io">首页</a>
                    
                    <a  href="https://forrestsu.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://forrestsu.github.io/todo/" title="TODO">TODO</a>
                    
                    <a  href="https://forrestsu.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        border: 1px solid #bbb;
        border-radius: 7px;
        margin: 1.1em 0 0 2em;
        padding: 0.7em 0.7em 0 0.7em;
        max-width: 40%;
        line-height: 1em;
        float: right;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

     
</style>
<div class="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-preface">1 Preface</a></li>
    <li><a href="#2-原理分析">2 原理分析</a>
      <ul>
        <li><a href="#21-shared_ptr">2.1 shared_ptr</a></li>
        <li><a href="#22-weak_ptr">2.2 weak_ptr</a></li>
        <li><a href="#23-make_sharedt">2.3 make_shared&lt;T&gt;()</a></li>
        <li><a href="#24-enable_shared_from_this">2.4 enable_shared_from_this</a></li>
        <li><a href="#25-unique_ptr">2.5 unique_ptr</a></li>
        <li><a href="#26-make_uniquet">2.6 make_unique&lt;T&gt;()</a></li>
      </ul>
    </li>
    <li><a href="#3-对象字节数64-bit-system">3 对象字节数（64 bit system）</a></li>
    <li><a href="#4-shared_ptr-和-weak_ptr-实现的细节">4 shared_ptr 和 weak_ptr 实现的细节</a></li>
    <li><a href="#5-最后">5 最后</a></li>
    <li><a href="#6-答疑">6 答疑</a></li>
    <li><a href="#附录">附录</a></li>
  </ul>
</nav>
    </div>
</div>

    <article class="post">
        <header>
            <h1 class="post-title">深入理解C&#43;&#43;11智能指针</h1>
        </header>
        <date class="post-meta meta-date">
            2017年4月7日 20:54:00
        </date>
        <div class="post-meta">
            <span>| 字数 </span>
            5924
        </div>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='https://forrestsu.github.io/categories/cpp'>CPP</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span> 阅读 </span><span id="busuanzi_value_page_pv"></span></span>
        </div>
        
        
        <div class="clear" style="display: none">
            <div class="toc-article">
                <div class="toc-title">文章目录</div>
            </div>
        </div>
        
        <div class="post-content">
            <h2 id="1-preface">1 Preface</h2>
<p>软件工程遇到的问题都可以通过增加一个<code>中间层</code>来解决, 智能指针也是基于这样的思想；</p>
<p>C++ 11 包含了以下 3 种常用的智能指针：</p>
<ul>
<li>std::unique_ptr</li>
<li>std::shared_ptr</li>
<li>std::weak_ptr</li>
</ul>
<p>包含头文件 <code>#include &lt;memory&gt;</code> 即可</p>
<h2 id="2-原理分析">2 原理分析</h2>
<h3 id="21-shared_ptr">2.1 shared_ptr</h3>
<p>直接用 shared_ptr 管理一个堆上的裸指针对象：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> gp1(<span style="color:#66d9ef">new</span> Good());
</code></pre></td></tr></table>
</div>
</div><p>
        <a data-fancybox="gallery" href="/images/cpp/shared_ptr.jpg">
            <img class="mx-auto" alt="shared_ptr" src="/images/cpp/shared_ptr.jpg" />
        </a>
    </p>
<h3 id="22-weak_ptr">2.2 weak_ptr</h3>
<p>weak_ptr类 和 shared_ptr类 的成员变量相同。</p>
<p>
        <a data-fancybox="gallery" href="/images/cpp/weak_ptr.jpg">
            <img class="mx-auto" alt="weak_ptr" src="/images/cpp/weak_ptr.jpg" />
        </a>
    </p>
<p><strong>为什么需要 weak_ptr?</strong><br>
因为 shared_ptr 是对象的强引用, 一旦发生循环引用,对象就无法析构, 所以 weak_ptr 出现就是为了<strong>解决循环引用</strong>的问题。<br>
打个不恰当的比喻：weak_ptr就像寄生虫，shared_ptr就是宿主。</p>
<p>weak_ptr 和 shared_ptr 内存结构相同(1 个原始对象指针 + ctrl_block_t 指针)；</p>
<p><strong>不同之处在于：</strong></p>
<p>(1) 不直接使用 weak_ptr 进行对象的各种操作<br>
每次使用 weak_ptr 时，提升一个shared_ptr<!-- raw HTML omitted -->, 然后使用shared_ptr; 但是如果提升失败，表示对象已经析构。</p>
<p>(2) 负责管理不同对象的生命周期<br>
shared_ptr 管理 <code>T*对象</code>的生命周期，而 weak_ptr 管理 <code>ctrl_block_t*</code> 的生命周期。</p>
<p>(3) 不对称<br>
shared_ptr 可以构造对象产生(make_shared<!-- raw HTML omitted -->() 或 shared_ptr(T*))，或者通过 weak_ptr 提升。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">weak_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> wp;
shared_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> sp <span style="color:#f92672">=</span> wp.lock(); <span style="color:#75715e">//提升
</span></code></pre></td></tr></table>
</div>
</div><p>weak_ptr<!-- raw HTML omitted --> 通过拷贝 shared_ptr<!-- raw HTML omitted --> 构造得到，或者直接拷贝(或移动构造)其他的 weak_ptr<!-- raw HTML omitted -->。<br>
<strong>也就是说, 第一个<code>有效的</code>weak_ptr<!-- raw HTML omitted --> 一定从 shared_ptr<!-- raw HTML omitted --> 拷贝得到的。</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">shared_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> sp;
weak_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> wp <span style="color:#f92672">=</span> sp;  <span style="color:#75715e">// 拷贝 shared_ptr 构造
</span><span style="color:#75715e"></span>weak_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> wp1 <span style="color:#f92672">=</span> wp; <span style="color:#75715e">// 拷贝 weak_ptr 构造 
</span><span style="color:#75715e"></span>weak_ptr<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> wp2 <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>move(wp1); <span style="color:#75715e">//weak_ptr move构造
</span></code></pre></td></tr></table>
</div>
</div><h3 id="23-make_sharedt">2.3 make_shared&lt;T&gt;()</h3>
<p>为什么要引入make_shared?</p>
<p>好处1: 把指针计数器和对象一次性<code>一起分配</code>；提高内存分配效率。<br>
好处2: 提高数据的局部性，引用计数和对象可能在同一内存页中(甚至是 same cache line)。</p>
<p>所以, 一般来说, 我们推荐使用 make_shared 来创建shared_ptr对象, 能够有效的减少一次堆的小对象分配。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> gp1 <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_shared<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span>();
</code></pre></td></tr></table>
</div>
</div><p>
        <a data-fancybox="gallery" href="/images/cpp/make_shared.png">
            <img class="mx-auto" alt="make_shared" src="/images/cpp/make_shared.png" />
        </a>
    </p>
<h3 id="24-enable_shared_from_this">2.4 enable_shared_from_this</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Good</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> std<span style="color:#f92672">::</span>enable_shared_from_this<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// public 继承
</span><span style="color:#75715e"></span>{
<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> getInstance() {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">shared_from_this</span>();
    }
    <span style="color:#f92672">~</span>Good() { std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Good::~Good() called&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl; }
};

<span style="color:#75715e">// Good: the two shared_ptr&#39;s share the same object
</span><span style="color:#75715e"></span>std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> gp1 <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_shared<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span>();
std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>Good<span style="color:#f92672">&gt;</span> gp2 <span style="color:#f92672">=</span> gp1<span style="color:#f92672">-&gt;</span>getInstance();
std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;gp2.use_count() = &#34;</span> <span style="color:#f92672">&lt;&lt;</span> gp2.use_count() <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#39;\n&#39;</span>; <span style="color:#75715e">// output 2
</span></code></pre></td></tr></table>
</div>
</div><p>c++ 为了解决class内部, 使用自身class的智能指针的问题，引入了<code>enable_shared_from_this</code>,<br>
enable_shared_from_this 这个类只包含一个 weak_ptr&lt;T&gt; 成员对象(16 bytes 2个指针),<br>
当每次调用<code>shared_from_this()</code>, 就通过 <code>weak_ptr</code> 提升创建一个 <code>shared_ptr</code> 对象。</p>
<p>其内存模型如下：</p>
<p>
        <a data-fancybox="gallery" href="/images/cpp/enable_shared_from_this.png">
            <img class="mx-auto" alt="enable_shared_from_this" src="/images/cpp/enable_shared_from_this.png" />
        </a>
    </p>
<h3 id="25-unique_ptr">2.5 unique_ptr</h3>
<p>unique_ptr&lt;&gt; 管理一个独占的指针对象;</p>
<p>
        <a data-fancybox="gallery" href="/images/cpp/unique_ptr_internal.gif">
            <img class="mx-auto" alt="unique_ptr_internal" src="/images/cpp/unique_ptr_internal.gif" />
        </a>
    </p>
<h3 id="26-make_uniquet">2.6 make_unique&lt;T&gt;()</h3>
<p>make_unique&lt;&gt; 只是 unique_ptr&lt;T&gt;(new T()) 语法糖的包装，
作用只是为了智能指都有<code>make_xxx</code>一个统一的写法而已。</p>
<h2 id="3-对象字节数64-bit-system">3 对象字节数（64 bit system）</h2>
<p>a&gt; shared_ptr， weak_ptr 由于内部都只包含两个pointer，所以都是 <code>16 bytes</code>;</p>
<p>b&gt; control_block&lt;T*&gt; 包含两个 atomic_llong 和一个指针，所以是 <code>24 bytes</code>;</p>
<p>c&gt; 特别地，如果采用 make_shared 来分配智能指针，不考虑内存对其的前提下，<br>
control_block&lt;T*&gt; 占用空间为 <code>16 + sizeof(T)</code></p>
<p>d&gt; unique_ptr 内部有一个 tuple&lt;T*,functor_class&gt; 成员, 这个tuple成员对象只占用 <code>8 bytes</code> ;</p>
<h2 id="4-shared_ptr-和-weak_ptr-实现的细节">4 shared_ptr 和 weak_ptr 实现的细节</h2>
<ul>
<li>
<p>当每次有新的 shared_ptr 生成时，会增加 _Sp_counted_base 的 _M_use_count (+1);</p>
</li>
<li>
<p>当每次有新的 weak_ptr 生成时，会增加 _Sp_counted_base 的 _M_weak_count (+1);</p>
</li>
<li>
<p>通过weak_ptr&lt;x&gt;::lock()函数可以获取x对象的强引用（shared_ptr）。<br>
<code>通过判断 !expired(){return _M_use_count == 0;}, 那么可以提升成功。</code></p>
</li>
<li>
<p>对应的，shared_ptr 析构时，会调用 _Sp_counted_base 的 _M_release 来使 _M_use_count (-1);</p>
</li>
<li>
<p>weak_ptr 析构时，会调用 _Sp_counted_base 的 _M_release 来使 _M_weak_count (-1);</p>
</li>
<li>
<p>当 _M_use_count 的数量为 0 的时候 就会释放，原始的对象(用户自定义对象) 的内存，但是不会释放
_Sp_counted_base 的内存。</p>
</li>
<li>
<p>当 _M_use_count 和 _M_weak_count 都为 0 的时候， 才会释放 _Sp_counted_base 的内存。</p>
</li>
</ul>
<h2 id="5-最后">5 最后</h2>
<p>最后，我们来看下智能指针内存空间分布：</p>
<blockquote>
<ol>
<li>智能指针对象自身是在当前的栈空间上，而智能指针<strong>管理的对象</strong>是在堆空间！</li>
<li>特别的，对于 shared_ptr 还多一个控制块对象，这个控制块也在堆空间上。</li>
</ol>
</blockquote>
<h2 id="6-答疑">6 答疑</h2>
<p>❓* 深挖 unique_ptr 的 tuple 成员对象为啥只占用8个字节？*</p>
<p>因为 gcc 内部实现tuple采用的是递归继承的方式，对应的继承树为:</p>
<blockquote>
<p>tuple&lt;T*,class functor()&gt; -&gt; tuple&lt;class functor()&gt; -&gt; tuple&lt;&gt;</p>
</blockquote>
<p>其中仿函数的缺省实现(简化版)：</p>
<blockquote>
<p>void operator()(Tp* ptr) const {
delete ptr;
}</p>
</blockquote>
<p>所以问题的本质是：<strong>继承一个没有任何成员的 class, 并不会增加类的大小！</strong></p>
<p>❓<em>make_shared 对象的内存可能无法及时回收？</em></p>
<p>make_shared 只分配一次内存, 这看起来很好. 减少了内存分配的开销。
问题来了, weak_ptr 会保持控制块(强引用, 以及弱引用的信息)的生命周期, 而因此连带着保持了对象分配的内存, 只有最后一个 weak_ptr 离开作用域时, 内存才会被释放. 原本强引用减为 0 时就可以释放的内存, 现在变为了强引用, 弱引用都减为 0 时才能释放, 意外的延迟了内存释放的时间. 这对于内存要求高的场景来说, 是一个需要注意的问题. 关于这个问题可以看这里 <a href="http://lanzkron.wordpress.com/2012/04/22/make_shared-almost-a-silver-bullet">make_shared, almost a silver bullet</a></p>
<h2 id="附录">附录</h2>
<p>测试代码:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">#pragma pack(1)
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;memory&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
{
    std<span style="color:#f92672">::</span>shared_ptr<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span> sp <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_shared<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span>(<span style="color:#e6db74">&#34;123&#34;</span>);
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof  std::shared_ptr&lt;string&gt; &#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span>(sp);
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof(int) &#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">int</span>) <span style="color:#f92672">&lt;&lt;</span>  <span style="color:#e6db74">&#34;, sizeof(string) &#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span>(std<span style="color:#f92672">::</span>string);
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof(_Atomic_word) &#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span>(_Atomic_word);

    sp.get();
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> size std::__shared_count(8) = &#34;</span>
        <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span>(std<span style="color:#f92672">::</span>__shared_count<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>__default_lock_policy<span style="color:#f92672">&gt;</span>(sp.get()));

    <span style="color:#66d9ef">typedef</span> std<span style="color:#f92672">::</span>_Sp_counted_ptr<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">*</span>,std<span style="color:#f92672">::</span>__default_lock_policy<span style="color:#f92672">&gt;</span> counter_ptr;

    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> counter_ptr size :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (counter_ptr);

    <span style="color:#66d9ef">typedef</span> std<span style="color:#f92672">::</span>_Sp_counted_ptr_inplace<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>__default_lock_policy<span style="color:#f92672">&gt;</span> counter_in_place;
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> counter_in_place :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (counter_in_place);

    <span style="color:#66d9ef">typedef</span> std<span style="color:#f92672">::</span>_Sp_counted_ptr_inplace<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span>, std<span style="color:#f92672">::</span>allocator<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">char</span><span style="color:#f92672">&gt;</span>, std<span style="color:#f92672">::</span>__default_lock_policy<span style="color:#f92672">&gt;</span> counter_in_place_char;
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> counter_in_place_char :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (counter_in_place_char);

    <span style="color:#66d9ef">typedef</span> std<span style="color:#f92672">::</span>enable_shared_from_this<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span> from_this;
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> from_this (equals weak_ptr&lt;T&gt;):&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (from_this);

    <span style="color:#66d9ef">typedef</span>  std<span style="color:#f92672">::</span>weak_ptr<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span> weak_ptr_tp;
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> weak_ptr_tp :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (weak_ptr_tp);

    std<span style="color:#f92672">::</span>unique_ptr<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span> up <span style="color:#f92672">=</span> std<span style="color:#f92672">::</span>make_unique<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;</span>(<span style="color:#e6db74">&#34;hello&#34;</span>);
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof(up) :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (up); <span style="color:#75715e">// 8 bytes
</span><span style="color:#75715e"></span>
    std<span style="color:#f92672">::</span>__uniq_ptr_impl<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string, std<span style="color:#f92672">::</span>default_delete<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;&gt;</span> unique_imp;

    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof(unique_imp) :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (unique_imp); <span style="color:#75715e">// 8 bytes
</span><span style="color:#75715e"></span>
    std<span style="color:#f92672">::</span>tuple<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">*</span>, std<span style="color:#f92672">::</span>default_delete<span style="color:#f92672">&lt;</span>std<span style="color:#f92672">::</span>string<span style="color:#f92672">&gt;&gt;</span> tup;
    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> sizeof(tuple&lt;pointer, deleter()&gt;) :&#34;</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">sizeof</span> (tup); <span style="color:#75715e">// 8 bytes
</span><span style="color:#75715e"></span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>;
    <span style="color:#66d9ef">return</span>  <span style="color:#ae81ff">0</span>;
}
<span style="color:#75715e">#pragma pack()
</span></code></pre></td></tr></table>
</div>
</div><p>输出结果：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * # g++ -g -Wall main.cpp -o a.out
</span><span style="color:#75715e"> * # ./a.out
</span><span style="color:#75715e">sizeof  std::shared_ptr&lt;string&gt; 16
</span><span style="color:#75715e">sizeof(int) 4, sizeof(string) 8
</span><span style="color:#75715e">sizeof(_Atomic_word) 4
</span><span style="color:#75715e">size std::__shared_count(8) = 8
</span><span style="color:#75715e"> counter_ptr size :24
</span><span style="color:#75715e"> counter_in_place :20
</span><span style="color:#75715e"> counter_in_place_char :17
</span><span style="color:#75715e"> from_this (equals weak_ptr&lt;T&gt;):16
</span><span style="color:#75715e"> weak_ptr_tp :16
</span><span style="color:#75715e"> sizeof(up) :8
</span><span style="color:#75715e"> sizeof(unique_imp) :8
</span><span style="color:#75715e"> sizeof(tuple&lt;pointer, deleter()&gt;) :8
</span><span style="color:#75715e">*/</span>
</code></pre></td></tr></table>
</div>
</div><p>last update: 2020-08-04 17:30:04 by sunquan</p>

        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/work/%E6%81%92%E7%94%9F%E4%B8%80%E5%B9%B4%E5%8D%8A%E5%B7%A5%E4%BD%9C%E4%BD%93%E9%AA%8C/">恒生一年半工作体验</a></li>
        
        <li><a href="/posts/library/zeromq-%E5%85%A5%E9%97%A8/">zeromq 入门</a></li>
        
        <li><a href="/posts/life/%E6%88%91%E7%9A%84%E5%A4%A7%E5%AD%A6%E5%AF%BC%E5%B8%88-%E8%B4%BA%E8%80%81%E5%B8%88/">我的大学导师 (贺老师)</a></li>
        
        <li><a href="/posts/work/%E6%81%92%E7%94%9F%E5%B7%A5%E4%BD%9C%E6%A2%B3%E7%90%86/">恒生工作梳理</a></li>
        
        <li><a href="/posts/cpp/posix-process-vs-thread/">posix 进程 vs. 线程 </a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://forrestsu.github.io/tags/c&#43;&#43;11'>c&#43;&#43;11</a></li>
                
                <li><a href='https://forrestsu.github.io/tags/weak_ptr'>weak_ptr</a></li>
                
                <li><a href='https://forrestsu.github.io/tags/unique_ptr'>unique_ptr</a></li>
                
                <li><a href='https://forrestsu.github.io/tags/shared_ptr'>shared_ptr</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "ForrestSu/ForrestSu.github.io"
            issue-term="title"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2021 <a href="https://forrestsu.github.io">程序员的冷浪漫 By ForrestSun</a>
        .Powered by <a rel="nofollow noreferer noopener" href="https://blog.csdn.net/sunquana" target="_blank">sunquan</a>.
        
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script><script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='//www.google.com/search' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://forrestsu.github.io">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://forrestsu.github.io/posts/tools/wireshark_lua_tcp_desegment/" title="wireshark lua 插件tcp报文分段(desegment)？">wireshark lua 插件tcp报文分段(desegment)？</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/tools/wireshark_lua_trap/" title="wireshark lua 插件之 tvb():string()">wireshark lua 插件之 tvb():string()</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/tools/wireshark_plugin_qa/" title="wireshark插件，如何关联请求应答(如ping协议)？">wireshark插件，如何关联请求应答(如ping协议)？</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/go/golang-recommend-pkgs/" title="Go 常用的包推荐 (持续更新)">Go 常用的包推荐 (持续更新)</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/cpp/narrow-cast-no-warnning/" title="g&#43;&#43; -Wall 不提示 narrow-cast 的警告">g&#43;&#43; -Wall 不提示 narrow-cast 的警告</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/architecture-thinking/spring-eureka-registry/" title="Eureka 服务注册与发现-原理分析">Eureka 服务注册与发现-原理分析</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/git/git-owners-files-in-repos/" title="Git 项目仓库中的 OWNERS 文件">Git 项目仓库中的 OWNERS 文件</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/archi-seastar/seastar-ready-future/" title="Seastar 之 ready_future(3)">Seastar 之 ready_future(3)</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/architecture-thinking/cpu-cache/" title="CPU Cache 架构">CPU Cache 架构</a>
    </li>
    
    <li>
        <a href="https://forrestsu.github.io/posts/archi-seastar/seastar-inter-core-communication/" title="Seastar 之核间通信 (2)">Seastar 之核间通信 (2)</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href="/categories">分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://forrestsu.github.io/categories/algorithm/">Algorithm (5)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/architecture/">Architecture (10)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/cpp/">CPP (15)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/cs/">CS (5)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/diary/">Diary (6)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/git/">Git (5)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/go/">Go (4)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/highavailable/">HighAvailable (2)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/io/">IO (1)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/java/">Java (1)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/languages/">Languages (2)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/leetcode/">LeetCode (2)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/library/">Library (6)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/life/">Life (13)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/linux/">Linux (4)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/readingnotes/">ReadingNotes (7)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/resume/">Resume (1)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/todolist/">TodoList (1)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/tools/">Tools (14)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/travel/">Travel (3)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/web/">Web (5)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/work/">Work (11)</a></li>
    
    <li><a href="https://forrestsu.github.io/categories/%E6%B5%AE%E7%94%9F%E8%8B%A5%E6%A2%A6/">浮生若梦 (5)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href="/tags">标签</a></h3>
<div class="tagcloud">
    
    <a href="https://forrestsu.github.io/tags/2017/">2017(1)</a>
    
    <a href="https://forrestsu.github.io/tags/about/">about(1)</a>
    
    <a href="https://forrestsu.github.io/tags/ac%E8%87%AA%E5%8A%A8%E6%9C%BA/">AC自动机(1)</a>
    
    <a href="https://forrestsu.github.io/tags/algorithm/">Algorithm(1)</a>
    
    <a href="https://forrestsu.github.io/tags/architecture/">Architecture(2)</a>
    
    <a href="https://forrestsu.github.io/tags/atomic/">atomic(1)</a>
    
    <a href="https://forrestsu.github.io/tags/bigdata/">BigData(1)</a>
    
    <a href="https://forrestsu.github.io/tags/blog/">blog(1)</a>
    
    <a href="https://forrestsu.github.io/tags/c&#43;&#43;11/">C&#43;&#43;11(3)</a>
    
    <a href="https://forrestsu.github.io/tags/cache/">cache(1)</a>
    
    <a href="https://forrestsu.github.io/tags/chrome/">chrome(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cluster/">cluster(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cmake/">CMake(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cmder/">cmder(1)</a>
    
    <a href="https://forrestsu.github.io/tags/communication/">communication(1)</a>
    
    <a href="https://forrestsu.github.io/tags/core/">core(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cpp/">CPP(9)</a>
    
    <a href="https://forrestsu.github.io/tags/cps/">CPS(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cpu/">CPU(1)</a>
    
    <a href="https://forrestsu.github.io/tags/cs/">CS(4)</a>
    
    <a href="https://forrestsu.github.io/tags/diary/">Diary(6)</a>
    
    <a href="https://forrestsu.github.io/tags/dp/">DP(1)</a>
    
    <a href="https://forrestsu.github.io/tags/duck-type/">duck-type(1)</a>
    
    <a href="https://forrestsu.github.io/tags/epoll/">epoll(1)</a>
    
    <a href="https://forrestsu.github.io/tags/etcd/">etcd(1)</a>
    
    <a href="https://forrestsu.github.io/tags/eureka/">Eureka(1)</a>
    
    <a href="https://forrestsu.github.io/tags/eventfd/">eventfd(1)</a>
    
    <a href="https://forrestsu.github.io/tags/feeling/">Feeling(1)</a>
    
    <a href="https://forrestsu.github.io/tags/future/">future(2)</a>
    
    <a href="https://forrestsu.github.io/tags/git/">Git(5)</a>
    
    <a href="https://forrestsu.github.io/tags/hardware/">hardware(1)</a>
    
    <a href="https://forrestsu.github.io/tags/hundsun/">Hundsun(2)</a>
    
    <a href="https://forrestsu.github.io/tags/java/">Java(1)</a>
    
    <a href="https://forrestsu.github.io/tags/kafka/">kafka(1)</a>
    
    <a href="https://forrestsu.github.io/tags/lambda/">lambda(1)</a>
    
    <a href="https://forrestsu.github.io/tags/languages/">Languages(2)</a>
    
    <a href="https://forrestsu.github.io/tags/library/">Library(6)</a>
    
    <a href="https://forrestsu.github.io/tags/life/">Life(12)</a>
    
    <a href="https://forrestsu.github.io/tags/linklist/">LinkList(1)</a>
    
    <a href="https://forrestsu.github.io/tags/microservices/">MicroServices(1)</a>
    
    <a href="https://forrestsu.github.io/tags/narrow-cast/">narrow cast(1)</a>
    
    <a href="https://forrestsu.github.io/tags/nullptr/">nullptr(1)</a>
    
    <a href="https://forrestsu.github.io/tags/owners/">owners(1)</a>
    
    <a href="https://forrestsu.github.io/tags/pkg/">pkg(1)</a>
    
    <a href="https://forrestsu.github.io/tags/plan/">plan(1)</a>
    
    <a href="https://forrestsu.github.io/tags/plugin/">plugin(4)</a>
    
    <a href="https://forrestsu.github.io/tags/poll/">poll(1)</a>
    
    <a href="https://forrestsu.github.io/tags/promise/">promise(1)</a>
    
    <a href="https://forrestsu.github.io/tags/putty/">putty(1)</a>
    
    <a href="https://forrestsu.github.io/tags/rb-tree/">rb-tree(1)</a>
    
    <a href="https://forrestsu.github.io/tags/reactive/">Reactive(1)</a>
    
    <a href="https://forrestsu.github.io/tags/readingnotes/">ReadingNotes(7)</a>
    
    <a href="https://forrestsu.github.io/tags/ready_future/">ready_future(1)</a>
    
    <a href="https://forrestsu.github.io/tags/recommend/">recommend(1)</a>
    
    <a href="https://forrestsu.github.io/tags/reflection/">reflection(1)</a>
    
    <a href="https://forrestsu.github.io/tags/registry-center/">Registry Center(1)</a>
    
    <a href="https://forrestsu.github.io/tags/resume/">resume(1)</a>
    
    <a href="https://forrestsu.github.io/tags/rpm/">rpm(1)</a>
    
    <a href="https://forrestsu.github.io/tags/seastar/">seastar(4)</a>
    
    <a href="https://forrestsu.github.io/tags/select/">select(2)</a>
    
    <a href="https://forrestsu.github.io/tags/shared_ptr/">shared_ptr(1)</a>
    
    <a href="https://forrestsu.github.io/tags/sigabrt/">SIGABRT(1)</a>
    
    <a href="https://forrestsu.github.io/tags/sql/">sql(1)</a>
    
    <a href="https://forrestsu.github.io/tags/ssh/">ssh(1)</a>
    
    <a href="https://forrestsu.github.io/tags/stdthread/">std::thread(1)</a>
    
    <a href="https://forrestsu.github.io/tags/syscall/">syscall(1)</a>
    
    <a href="https://forrestsu.github.io/tags/teamviewer/">TeamViewer(1)</a>
    
    <a href="https://forrestsu.github.io/tags/timeout/">timeout(1)</a>
    
    <a href="https://forrestsu.github.io/tags/todolist/">TodoList(1)</a>
    
    <a href="https://forrestsu.github.io/tags/tools/">Tools(12)</a>
    
    <a href="https://forrestsu.github.io/tags/travel/">Travel(3)</a>
    
    <a href="https://forrestsu.github.io/tags/ubuntu/">ubuntu(2)</a>
    
    <a href="https://forrestsu.github.io/tags/unique_ptr/">unique_ptr(1)</a>
    
    <a href="https://forrestsu.github.io/tags/unwound-stack/">unwound stack(1)</a>
    
    <a href="https://forrestsu.github.io/tags/wall/">-Wall(1)</a>
    
    <a href="https://forrestsu.github.io/tags/weak_ptr/">weak_ptr(1)</a>
    
    <a href="https://forrestsu.github.io/tags/web/">Web(5)</a>
    
    <a href="https://forrestsu.github.io/tags/wireshark/">Wireshark(3)</a>
    
    <a href="https://forrestsu.github.io/tags/work/">Work(9)</a>
    
    <a href="https://forrestsu.github.io/tags/zeromq/">zeromq(1)</a>
    
    <a href="https://forrestsu.github.io/tags/zookeeper/">zookeeper(2)</a>
    
    <a href="https://forrestsu.github.io/tags/%E4%BC%98%E7%82%B9/">优点(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E5%A4%9A%E6%A8%A1%E5%8C%B9%E9%85%8D/">多模匹配(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/">工作总结(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E6%80%BB%E7%BB%93/">总结(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E6%89%94%E9%B8%A1%E8%9B%8B%E9%97%AE%E9%A2%98/">扔鸡蛋问题(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E7%BC%BA%E7%82%B9/">缺点(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E7%BE%A4%E6%94%B6%E6%AC%BE/">群收款(1)</a>
    
    <a href="https://forrestsu.github.io/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/">背包问题(1)</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="http://tanqidong1992.github.io" title="偶尔记一些东西">tanqidong1992</a>
        </li>
        
        <li>
            <a target="_blank" href="http://test.i-h5.cn/egret/study" title="学而不思则罔，思而不学则殆">白鹭引擎Study Room</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://forrestsu.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>